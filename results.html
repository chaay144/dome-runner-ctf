<!doctype html>
<!-- vFINAL-CTF results -->
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dome Runner CTF — Results</title>
<style>
  :root{--bg:#0b1020;--card:#121a33;--muted:#9db0f5;--text:#e7ecff;--accent:#66e3ff;--accent2:#7bffb3}
  *{box-sizing:border-box} body{margin:0;background:#0b1020;color:var(--text);font-family:system-ui,Inter,Segoe UI,Roboto,Arial}
  main{max-width:800px;margin:0 auto;padding:24px}
  h1{margin:0 0 8px 0} .sub{color:#9db0f5;font-size:13px}
  .card{margin-top:16px;background:#121a33;border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:16px}
  .bar{height:12px;border-radius:999px;background:#0c132a;border:1px solid #23305a;overflow:hidden}
  .bar>span{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0%}
  .pill{padding:4px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.18);display:inline-block}
  .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .btn{border:0;background:linear-gradient(135deg,var(--accent),var(--accent2));padding:8px 12px;border-radius:12px;color:#001018;font-weight:800;cursor:pointer;text-decoration:none}
</style>
</head>
<body>
<main>
  <h1>Results</h1>
  <div class="sub">This page summarizes your score for the current session (reload resets progress).</div>

  <div class="card">
    <div class="row">
      <div id="score" class="pill">Score: 0 / 0 (0%)</div>
    </div>
    <div class="bar" style="margin:12px 0 6px"><span id="prog"></span></div>
  </div>

  <div class="card" id="list"></div>

  <div class="row" style="margin-top:14px">
    <a class="btn" href="index.html">Back to challenges</a>
  </div>
</main>

<script>
(function(){
  const RUN = JSON.parse(sessionStorage.getItem('RUN') || '{}');
  const DATA = JSON.parse(sessionStorage.getItem('DATA') || '[]');

  function render(){
    const total = DATA.reduce((a,c)=>a+c.points,0);
    const score = DATA.reduce((a,c)=> a + (RUN[c.id]?c.points:0), 0);
    const pct = total ? Math.round((score/total)*1000)/10 : 0;

    document.getElementById('score').textContent = `Score: ${score} / ${total} (${pct}%)`;
    document.getElementById('prog').style.width = Math.min(100,pct) + '%';

    const list=document.getElementById('list');
    list.innerHTML = "<div style='font-weight:700;margin-bottom:8px'>Per-challenge:</div>";
    for(const c of DATA){
      const ok = !!RUN[c.id];
      const row = document.createElement('div');
      row.style = 'display:flex;justify-content:space-between;padding:6px 0;border-top:1px solid rgba(255,255,255,.08)';
      row.innerHTML =
        `<div>${c.id}. ${c.title} <span style="color:#9db0f5;font-size:12px">(${c.difficulty} • ${c.points}m)</span></div>`+
        `<div style="font-weight:800;${ok?'color:#87ff87':'color:#ff6b6b'}">${ok?'✓':'✗'}</div>`;
      list.appendChild(row);
    }
  }
  render();
})();
</script>
</body>
</html>
